{"version":3,"file":"compromise-redact.js","sources":["../src/redact.js","../src/index.js"],"sourcesContent":["const randChar = function(char) {\n  let len = Math.random() * 10\n  len = Math.ceil(len)\n  let str = ''\n  for (let i = 0; i < len; i++) {\n    str += char\n  }\n  return str\n}\n\nconst doProp = function(doc, prop, options, tag) {\n  // not false\n  if (options[prop]) {\n    let m = doc[prop]()\n    // replace with custom char of random length\n    if (typeof options[prop] === 'string') {\n      if (options[prop].length === 1) {\n        m.replaceWith(randChar(options[prop]))\n      } else {\n        m.replaceWith(options[prop])\n      }\n    }\n    // support a custom function\n    else if (typeof options[prop] === 'function') {\n      let fn = options[prop]\n      m.replaceWith(fn(m))\n    }\n    // optionally, tag the replacement\n    if (tag) {\n      m.tag(tag, 'redact-' + prop)\n    }\n  }\n}\n\nconst redact = function(doc, options) {\n  doProp(doc, 'dates', options, 'Date')\n  doProp(doc, 'numbers', options, 'Value')\n  doProp(doc, 'money', options, 'Money')\n  doProp(doc, 'people', options, 'Person')\n  doProp(doc, 'places', options, 'Place')\n  doProp(doc, 'organizations', options, 'Organization')\n  return doc\n}\nmodule.exports = redact\n","const redact = require('./redact')\n\nconst defaults = {\n  dates: '▇',\n  numbers: false,\n  money: '▇',\n  people: '▇',\n  places: '▇',\n  organizations: '▇',\n}\n\nconst addMethod = function(Doc) {\n  /** remove or obfuscate certain parts of the text */\n  Doc.prototype.redact = function(options) {\n    options = Object.assign({}, defaults, options)\n    return redact(this, options)\n  }\n\n  return Doc\n}\nmodule.exports = addMethod\n"],"names":["randChar","char","len","Math","random","ceil","str","i","doProp","doc","prop","options","tag","m","length","replaceWith","fn","redact","defaults","dates","numbers","money","people","places","organizations","addMethod","Doc","prototype","Object","assign"],"mappings":"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"}